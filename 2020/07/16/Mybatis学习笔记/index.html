<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<script>
    (function () {
        if ('') {
            if (prompt('请输入文章密码') !== '') {
                alert('密码错误！');
                if (history.length === 1) {
                    location.replace("http://canghaizanhua6.github.io/"); // 这里替换成你的首页
                } else {
                    history.back();
                }
            }
        }
    })();
</script>

<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>

<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/vendors/pace/pace.min.js?v=1.0.2"></script>
  <link href="/vendors/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "c32af648"
    });
  daovoice('update');
  </script>














  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />







  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo3.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Mybatis学习笔记," />





  <link rel="alternate" href="/atom.xml" title="poppy" type="application/atom+xml" />






<meta name="description" content="Mybatis学习基础知识为什么要使用Mybatis? JDBC开发的问题： SQL夹在Java代码块中，耦合度高导致硬编码内伤 维护不易且实际开发需求中sql是有变化的，频繁修改的情况多见   Hibernate的问题 长难复杂SQL，对于Hibernate而言处理也不容易 内部自动生成的SQL，不容易做特殊优化 基于全映射的全自动框架，大量字段的POJO进行部分映射时比较困难，导致数据库性能下">
<meta property="og:type" content="article">
<meta property="og:title" content="Mybatis学习笔记">
<meta property="og:url" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="poppy">
<meta property="og:description" content="Mybatis学习基础知识为什么要使用Mybatis? JDBC开发的问题： SQL夹在Java代码块中，耦合度高导致硬编码内伤 维护不易且实际开发需求中sql是有变化的，频繁修改的情况多见   Hibernate的问题 长难复杂SQL，对于Hibernate而言处理也不容易 内部自动生成的SQL，不容易做特殊优化 基于全映射的全自动框架，大量字段的POJO进行部分映射时比较困难，导致数据库性能下">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/7.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/8.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/9.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/11.jpg">
<meta property="og:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/12.jpg">
<meta property="article:published_time" content="2020-07-16T08:20:24.000Z">
<meta property="article:modified_time" content="2020-07-31T12:21:06.045Z">
<meta property="article:author" content="yang qian">
<meta property="article:tag" content="Mybatis学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'poppy'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://canghaizanhua6.github.io/2020/07/16/Mybatis学习笔记/"/>





  <title>Mybatis学习笔记 | poppy</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?27d543fbbb1cd5efcafce20d63aa0b03";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




<meta name="generator" content="Hexo 4.2.0"></head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  
  <script type="text/javascript"
  color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/canghaizanhua6" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>


    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">poppy</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生如逆旅，我亦是行人</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://canghaizanhua6.github.io/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yang qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="poppy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Mybatis学习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-07-16T16:20:24+08:00">
                2020-07-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categoriespsot_asset_folder/%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index">
                    <span itemprop="name">框架基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="leancloud_visitors" data-flag-title="Mybatis学习笔记">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span></span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  34
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Mybatis学习"><a href="#Mybatis学习" class="headerlink" title="Mybatis学习"></a>Mybatis学习</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="为什么要使用Mybatis"><a href="#为什么要使用Mybatis" class="headerlink" title="为什么要使用Mybatis?"></a>为什么要使用Mybatis?</h4><ul>
<li>JDBC开发的问题：<ul>
<li>SQL夹在Java代码块中，耦合度高导致硬编码内伤</li>
<li>维护不易且实际开发需求中sql是有变化的，频繁修改的情况多见</li>
</ul>
</li>
<li>Hibernate的问题<ul>
<li>长难复杂SQL，对于Hibernate而言处理也不容易</li>
<li>内部自动生成的SQL，不容易做特殊优化</li>
<li>基于全映射的全自动框架，大量字段的POJO进行部分映射时比较困难，导致数据库性能下降</li>
</ul>
</li>
<li>使用Mybatis<ul>
<li>Mybatis是一个半自动化的持久层框架</li>
<li>对于开发人员来说，核心SQL还是需要自己优化</li>
<li>SQL和Java编码分开，功能边界清晰，一个专注业务，一个专注数据。</li>
</ul>
</li>
</ul>
<h4 id="mybatis框架原理"><a href="#mybatis框架原理" class="headerlink" title="mybatis框架原理"></a>mybatis框架原理</h4><h4 id="mybatis入门程序"><a href="#mybatis入门程序" class="headerlink" title="mybatis入门程序"></a>mybatis入门程序</h4><ul>
<li><p>创建数据库，并创建一个员工表</p>
<blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> mybatis;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_emp(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">INT</span>(<span class="number">11</span>) primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">last_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">gender <span class="built_in">char</span>(<span class="number">1</span>),</span><br><span class="line">email <span class="built_in">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>导入jar包</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.jpg" alt="导入jar包"></p>
</li>
<li><p>创建实体类</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.jpg" alt="实体类"></p>
</li>
<li><p>创建配置文件</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.jpg" alt="所有配置文件"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta"> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		 		<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">			 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">			 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql:///mybatis?seUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8"</span>/&gt;</span></span><br><span class="line">			 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">			 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"9746al"</span>/&gt;</span></span><br><span class="line">		 <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- 映射配置文件 --&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	     <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"EmployeeMapper.xml"</span>/&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta"> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> namespace:名称空间，可以任意取，但是在使用唯一标识获取数据库中字段时最好加上名称空间，防止出错</span></span><br><span class="line"><span class="comment"> id:唯一标识，任意取</span></span><br><span class="line"><span class="comment"> resultType：返回类型</span></span><br><span class="line"><span class="comment">last_name lastname : lastname作为别名出现</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.xidian.EmployeeMapper"</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectEmp"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">	    select id,last_name lastname,gender,email from tb_emp where id = #&#123;id&#125;</span><br><span class="line">	 <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeTest</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 1.先加载全局配置文件，根据全局配置文件创建一个sqlSessionFactory</span></span><br><span class="line"><span class="comment">	 * 2.sql映射文件，配置了每一个sql，以及sql的封装规则等</span></span><br><span class="line"><span class="comment">	 * 3.将映射文件加入到全局配置文件中</span></span><br><span class="line"><span class="comment">	 * 4.使用sqlSessionFactory获取sqlSession</span></span><br><span class="line"><span class="comment">	 * 5.使用sqlSession对数据库进行增删改查</span></span><br><span class="line"><span class="comment">	 *   一个sqlSession就代表和数据库的一次会话，用完关闭</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">		InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">		</span><br><span class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			Employee employee = sqlSession.selectOne(<span class="string">"com.xidian.EmployeeMapper.selectEmp"</span>, <span class="number">1</span>);</span><br><span class="line">			System.err.println(employee.toString());</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>接口式编程</p>
<ul>
<li><p>创建一个定义了获取方式的接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeMapper</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​</p>
</li>
<li><p>修改配置文件，将接口绑定在配置文件中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> namespace:名称空间，写成定义了获取方式的接口类路径</span></span><br><span class="line"><span class="comment"> id:唯一标识，具体的方法名</span></span><br><span class="line"><span class="comment"> resultType：返回类型</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.xidian.dao.EmployeeMapper"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">    select id,last_name lastname,gender,email from tb_emp where id = #&#123;id&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​</p>
</li>
<li><p>修改代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">  <span class="comment">//获取sqlsession工厂</span></span><br><span class="line">  SqlSessionFactory sqlSessionFactory = getSqlSessionFactory();</span><br><span class="line">  <span class="comment">//获取sqlsession</span></span><br><span class="line">  SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">  <span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">//获取定义了获取方式的接口的实现类</span></span><br><span class="line">    EmployeeMapper employee = sqlSession.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(employee.toString());</span><br><span class="line">    Employee employee2 = employee.getEmpById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(employee2.toString());</span><br><span class="line">  &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">    sqlSession.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>总结：</p>
<ul>
<li><p>接口式编程</p>
<blockquote>
<p>原生：Dao  ==&gt; DaoImpl</p>
<p>mybatis：Mapper ==&gt; Mappper.xml</p>
</blockquote>
</li>
<li><p>sqlSession相当于和数据库的一次会话，用完就关闭</p>
</li>
<li><p>sqlSession和connect一样都是线程不安全的，每次使用的都要创建新的对象</p>
</li>
<li><p>Mapper接口没有实现类，但是mybatis会为接口创建一个代理类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//接口需要和xml进行绑定</span></span><br><span class="line">EmployeeMapper empMapper = sqlSession.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>两个重要的配置文件</p>
<ul>
<li><p>mybatis的全局配置文件：包含数据库连接池信息，事务管理器信息…等系统运行环境信息</p>
</li>
<li><p>sql映射文件：一定要有的，保存每一个sql语句映射信息</p>
<p>将sql抽取出来</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><h4 id="全局配置文件"><a href="#全局配置文件" class="headerlink" title="全局配置文件"></a>全局配置文件</h4><ul>
<li><p>标签</p>
<ul>
<li><p>properties</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- properties：引入外部属性文件</span></span><br><span class="line"><span class="comment">            resource:引入类路径下的属性文件</span></span><br><span class="line"><span class="comment">            url:引入网络上的或者磁盘上的属性文件</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"jdbc.properties"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>settings</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--settings：包含很多的设置项</span></span><br><span class="line"><span class="comment">        setting：代表每一个具体的设置项</span></span><br><span class="line"><span class="comment">           name：设置项的名称</span></span><br><span class="line"><span class="comment">           value：设置项的值</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--驼峰命名法--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>typeAliases</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- typeAliases: 为类设置别名</span></span><br><span class="line"><span class="comment">             typeAlias：为每个类设置别名，默认设置为类名小写，实际上部分大小写，只要是类名即可</span></span><br><span class="line"><span class="comment">                 type：类路径</span></span><br><span class="line"><span class="comment">                 alias：别名</span></span><br><span class="line"><span class="comment">             package：为某个包下的所有类设置别名，默认为类名小写</span></span><br><span class="line"><span class="comment">                 name：包名</span></span><br><span class="line"><span class="comment">             </span></span><br><span class="line"><span class="comment">            使用@Alias("emp")注解方式为某个包下的类设置别名  </span></span><br><span class="line"><span class="comment">     </span></span><br><span class="line"><span class="comment">     --&gt;</span> </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- &lt;typeAlias type="com.xidian.domain.Employee" alias="emp"/&gt; --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.xidian.domain"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>environments</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--environments：环境配置,通过default属性指定当前环境</span></span><br><span class="line"><span class="comment">      environment ：配置每一个环境，必须要有两个子标签，属性id表示环境的唯一标识</span></span><br><span class="line"><span class="comment">           transactionManager: 事务管理器；  JDBC(JdbcTransactionFactory)|MANAGED(ManagedTransactionFactory)</span></span><br><span class="line"><span class="comment">                   type：JDBC|MANAGED</span></span><br><span class="line"><span class="comment">                                     自定义事务管理器：实现TransactionFactory接口</span></span><br><span class="line"><span class="comment">            dataSource：数据源；POOLED(PooledDataSourceFactory)|JNDI(JndiDataSourceFactory)</span></span><br><span class="line"><span class="comment">                                |UNPOOLED(UnpooledDataSourceFactory)</span></span><br><span class="line"><span class="comment">                                                   自定义数据源:实现DataSourceFactory接口</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>databaseIdProvider</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--databaseIdProvider：数据库厂商   必须放在environments标签后面，否则会报错</span></span><br><span class="line"><span class="comment">         type: DB_VENDOR(VendorDatabaseIdProvider)</span></span><br><span class="line"><span class="comment">           name：数据库类型名</span></span><br><span class="line"><span class="comment">           value：数据库别名</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">databaseIdProvider</span> <span class="attr">type</span>=<span class="string">"DB_VENDOR"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"MySQL"</span> <span class="attr">value</span>=<span class="string">"mysql"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"Oracle"</span> <span class="attr">value</span>=<span class="string">"oracle"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"Sql Server"</span> <span class="attr">value</span>=<span class="string">"sqlserver"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">databaseIdProvider</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		 		<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">				 <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">					 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>/&gt;</span></span><br><span class="line">					 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line">					 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">					 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">				 <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">	         <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">	         <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">	             <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.master.driver&#125;"</span>/&gt;</span></span><br><span class="line">				 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.master.url&#125;"</span>/&gt;</span></span><br><span class="line">				 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.master.username&#125;"</span>/&gt;</span></span><br><span class="line">				 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.master.password&#125;"</span>/&gt;</span></span><br><span class="line">	         <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--映射配置文件</span></span><br><span class="line"><span class="comment">这样通过databaseId就可以选择使用的数据库环境</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.xidian.dao.EmployeeMapper"</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"emp"</span> <span class="attr">databaseId</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">	    select * from tb_emp where id = #&#123;id&#125;</span><br><span class="line">	 <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"emp"</span> <span class="attr">databaseId</span>=<span class="string">"oracle"</span>&gt;</span></span><br><span class="line">	    select * from tb_emp where id = #&#123;id&#125;</span><br><span class="line">	 <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>mappers</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mappers: 映射配置文件</span></span><br><span class="line"><span class="comment">       mapper:</span></span><br><span class="line"><span class="comment">        resource：类路径下的映射文件</span></span><br><span class="line"><span class="comment">        url：网络上或磁盘上的映射文件</span></span><br><span class="line"><span class="comment">        class：引用接口，但是需要将配置文件与接口放在同一个文件下</span></span><br><span class="line"><span class="comment">                注解方式：在接口方法上使用@Select("select * from tb_emp where id=#&#123;id&#125;"),然后在全局配置文件中使用class标签</span></span><br><span class="line"><span class="comment">                &lt;mapper class="com.xidian.dao.EmployeeMapper02"/&gt;</span></span><br><span class="line"><span class="comment">       package:为某个包中的接口进行映射</span></span><br><span class="line"><span class="comment">           name：包名，任然需要将映射文件和相应的接口放在一个文件夹中</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- &lt;mapper resource="EmployeeMapper.xml"/&gt; --&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- &lt;mapper class="com.xidian.dao.EmployeeMapper"/&gt; --&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- &lt;mapper class="com.xidian.dao.EmployeeMapper02"/&gt; --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.xidian.dao"</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="映射配置文件"><a href="#映射配置文件" class="headerlink" title="映射配置文件"></a>映射配置文件</h4><ul>
<li><p>select</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">resultType：返回类型</span></span><br><span class="line"><span class="comment"> databaseId：数据厂商唯一标识</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"emp"</span> <span class="attr">databaseId</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">	    select * from tb_emp where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--public List&lt;Employee&gt; getEmpByLastNameLike(String lastName);</span></span><br><span class="line"><span class="comment">         resultType: 返回值为List类型的，写入的是List中元素的类型</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByLastNameLike"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">      select * from tb_emp where last_name like #&#123;lastName&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>返回值为map</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/7.jpg" alt="返回值为map"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--public Map&lt;Integer,Employee&gt; getEmpByLastNameLikeReturnMap(String lastName);  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByLastNameLikeReturnMap"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">  select * from tb_emp where last_name like #&#123;lastName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- public Map&lt;String,Object&gt; getEmpByIdRetrunMap(Integer id);</span></span><br><span class="line"><span class="comment">         resultType:  直接使用mybatis为Map集合取的别名: map</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByIdRetrunMap"</span> <span class="attr">resultType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">  select * from tb_emp where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
<ul>
<li><p>自定义javaBean的封装规则</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--resultMap:自定义javaBean封装规则，和resultType只能存在一个</span></span><br><span class="line"><span class="comment">      属性</span></span><br><span class="line"><span class="comment">      type：映射实体类javaBean的类型</span></span><br><span class="line"><span class="comment">      id：唯一标识returnMap方便引用</span></span><br><span class="line"><span class="comment">     子标签：</span></span><br><span class="line"><span class="comment">     id：主键标签    </span></span><br><span class="line"><span class="comment">         column：表示在表中的列名</span></span><br><span class="line"><span class="comment">         property：实体类中属性名</span></span><br><span class="line"><span class="comment">     </span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Employee"</span> <span class="attr">id</span>=<span class="string">"myMap"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultMap</span>=<span class="string">"myMap"</span>&gt;</span></span><br><span class="line">    select * from tb_emp where id=#&#123;id&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>association级联查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--public Employee getEmpAndDeptById(Integer id);</span></span><br><span class="line"><span class="comment">        级联查询</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Employee"</span> <span class="attr">id</span>=<span class="string">"myDifMap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"dept.id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"dept.deptName"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- association：定义关联的单个对象的封装规则 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Employee"</span> <span class="attr">id</span>=<span class="string">"myDifMap2"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- association：定义关联的单个对象</span></span><br><span class="line"><span class="comment">                  property：关联对象在javaBean中属性</span></span><br><span class="line"><span class="comment">                  javaType：关联对象的类型</span></span><br><span class="line"><span class="comment">                  column：不能重复，property可以重复</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">javaType</span>=<span class="string">"com.xidian.domain.Department"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"deptName"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpAndDeptById"</span> <span class="attr">resultMap</span>=<span class="string">"myDifMap"</span>&gt;</span></span><br><span class="line">  select e.id id,e.last_name last_name,e.gender gender,e.email email,</span><br><span class="line">  d.id did,d.dept_name dept_name from tb_emp e,tb_dept d where      e.d_id=d.id and e.id=#&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>association的分步查询</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/8.jpg" alt="8"></p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/9.jpg" alt="9"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--association: 分步查询  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Employee"</span> <span class="attr">id</span>=<span class="string">"myStepMap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- association：分步</span></span><br><span class="line"><span class="comment">            property：javaBean中关联对象的属性</span></span><br><span class="line"><span class="comment">            select：表明当前对象时从哪个类中的那个方法中得到结果</span></span><br><span class="line"><span class="comment">            column：表明是根据主表中那个列的值传入到select方法中得到结果</span></span><br><span class="line"><span class="comment">         流程：从select中的指定的方法(传入column参数的值)得到结果设置到</span></span><br><span class="line"><span class="comment">               property代表的javaBean的属性中</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">select</span>=<span class="string">"com.xidian.dao.DepartmentMapper.getDeptById"</span> <span class="attr">column</span>=<span class="string">"d_id"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- public Employee getEmpAndDeptByStep(Integer id); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpAndDeptByStep"</span> <span class="attr">resultMap</span>=<span class="string">"myStepMap"</span>&gt;</span></span><br><span class="line">  select * from tb_emp where id=#&#123;id&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>association分段查询基础上+懒加载</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--懒加载设置   显示设置，防止版本更新带来的默认值的改变  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>collection关联查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Department"</span> <span class="attr">id</span>=<span class="string">"myDept"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"deptName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--collection：对于JavaBean中关联对象是一个集合的情况</span></span><br><span class="line"><span class="comment">             property：关联对象集合属性</span></span><br><span class="line"><span class="comment">             ofType：集合属性中元素的类型</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"list"</span>  <span class="attr">ofType</span>=<span class="string">"com.xidian.domain.Employee"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--public Department getDeptAndEmpById(Integer id);  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptAndEmpById"</span> <span class="attr">resultMap</span>=<span class="string">"myDept"</span>&gt;</span></span><br><span class="line">  select d.id did,d.dept_name dept_name,e.id id,e.last_name last_name,e.email          email,e.gender gender</span><br><span class="line">  from tb_dept d</span><br><span class="line">  left join tb_emp  e on d.id=e.d_id where d.id=#&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>collection分段查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Department"</span> <span class="attr">id</span>=<span class="string">"myDept2"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"deptName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--collection：对于JavaBean中关联对象是一个集合的情况</span></span><br><span class="line"><span class="comment">             property：关联对象集合属性</span></span><br><span class="line"><span class="comment">             select：从哪个类中哪个方法中获取集合属性的值</span></span><br><span class="line"><span class="comment">             column：需要传入select中的参数</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"list"</span>      <span class="attr">select</span>=<span class="string">"com.xidian.dao.EmployeeMapperPlus.getEmpAndDeptByDid"</span> </span></span><br><span class="line"><span class="tag">              <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--getDeptAndEmpByStep分段查询  --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptAndEmpByStep"</span> <span class="attr">resultMap</span>=<span class="string">"myDept2"</span>&gt;</span></span><br><span class="line">  select id,dept_name dept_name  from tb_dept where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">============================================</span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Department"</span> <span class="attr">id</span>=<span class="string">"myDept2"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"deptName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--collection：对于JavaBean中关联对象是一个集合的情况</span></span><br><span class="line"><span class="comment">             property：关联对象集合属性</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"list"</span>  <span class="attr">select</span>=<span class="string">"com.xidian.dao.EmployeeMapperPlus.getEmpAndDeptByDid"</span> </span></span><br><span class="line"><span class="tag">              <span class="attr">column</span>=<span class="string">"&#123;did=id&#125;"</span> <span class="attr">fetchType</span>=<span class="string">"lazy"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- column传多列值</span></span><br><span class="line"><span class="comment">               将多列封装成map </span></span><br><span class="line"><span class="comment">        &#123;key1=column1,key2=column2&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        fetchType：设置延迟加载的</span></span><br><span class="line"><span class="comment">           lazy：延迟加载</span></span><br><span class="line"><span class="comment">           eager：立即加载</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>discriminator判断器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- discriminator：判断器，通过判断某列的值返回不同的结果集 </span></span><br><span class="line"><span class="comment">     判断如果是女生，则将部门也查出来</span></span><br><span class="line"><span class="comment">     否则，将email作为last_name查询出来</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xidian.domain.Employee"</span> <span class="attr">id</span>=<span class="string">"myStepMap2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--discriminator</span></span><br><span class="line"><span class="comment">          javaType：列的类型</span></span><br><span class="line"><span class="comment">          column：通过那列判断</span></span><br><span class="line"><span class="comment">        case：</span></span><br><span class="line"><span class="comment">          value:判断的列的值</span></span><br><span class="line"><span class="comment">          resultType：封装的类型</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">discriminator</span> <span class="attr">javaType</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"gender"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">"0"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">select</span>=<span class="string">"com.xidian.dao.DepartmentMapper.getDeptById"</span> <span class="attr">column</span>=<span class="string">"d_id"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">      <span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">discriminator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>insert</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 增加: public void addEmp(Employee employee); </span></span><br><span class="line"><span class="comment">       parameterType：参数类型，可忽略</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">       mysql也是支持自增主键的，mybatis自增主键的值通过statement.getGenereatedKeys()获取</span></span><br><span class="line"><span class="comment">       useGeneratedKeys：使用自增主键获取主键策略</span></span><br><span class="line"><span class="comment">       keyProperty：将获取到的主键封装到实体类中</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addEmp"</span> <span class="attr">parameterType</span>=<span class="string">"com.xidian.dao.EmployeeMapper"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">  insert into tb_emp values(null,#&#123;lastName&#125;,#&#123;gender&#125;,#&#123;email&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>update</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 修改 : public void updateEmpById(int id);  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateEmp"</span>&gt;</span></span><br><span class="line">  update tb_emp set last_name=#&#123;lastName&#125; ,gender=#&#123;gender&#125;,email=#&#123;email&#125; where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>delete</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 删除 : public void delEmp(Employee employee);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"delEmpById"</span>&gt;</span></span><br><span class="line">  delete from tb_emp where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>参数问题：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">1.单个参数：mybatis不会做限定，因为我们只传了一个参数</span><br><span class="line">        #&#123;参数名&#125;: 取出参数的值，参数名任意</span><br><span class="line">        </span><br><span class="line">2.多个参数：mybatis会做特殊处理</span><br><span class="line">           多个参数会被封装到一个map中</span><br><span class="line">        key：写为param1,...,paramN或者0,...,n的索引都行</span><br><span class="line">        value：传入的参数值</span><br><span class="line">        #&#123;&#125;：从map中取出的指定key值</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">       异常：Parameter 'id' not found. </span><br><span class="line">            Available parameters are [0, 1, param1, param2]</span><br><span class="line">       操作：方法：public Employee getEmpByIdAndName(Integer id,String lastName);</span><br><span class="line">            取值：select * from tb_emp where id = #&#123;id&#125; and last_name=#&#123;lastName&#125;</span><br><span class="line">                 </span><br><span class="line">       命名参数：在接口方法参数前面使用@Param("id")命别名</span><br><span class="line">                如：public Employee getEmpByIdAndName(@Param("id")Integer     id,@Param("lastName")String lastName);</span><br><span class="line">                且在取值时需要写上返回类型： resultType="emp"</span><br><span class="line">                </span><br><span class="line">如果多个参数正好是我们业务逻辑的数据模型，我们就可以直接传入pojo就行</span><br><span class="line">   #&#123;属性名&#125;：取出传入的pojo的属性值</span><br><span class="line"></span><br><span class="line">如果多个参数不是业务模型中的数据，没有对应的pojo，那么我们直接传入一个map</span><br><span class="line">   方法：public Employee getEmpByMap(Map&lt;String,Object&gt; map);</span><br><span class="line">   取值：#&#123;key&#125; ：取出map中指定key对应的值</span><br><span class="line">   </span><br><span class="line">如果参数过多，且是我们常用的参数，那么我们可以创建一个TO(transportation object)</span><br><span class="line">	PageBean&#123;</span><br><span class="line">	  int curPage;</span><br><span class="line">	  int totalPage;</span><br><span class="line">	  ....</span><br><span class="line">	&#125;</span><br><span class="line">===============================================</span><br><span class="line">public Employee getEmp(@Prama("id")Integer id,String lastName);</span><br><span class="line">   取值：id==&gt;#&#123;id/param1&#125;   lastName==&gt;#&#123;param2&#125;</span><br><span class="line">public Employee getEmp(Integer id,@Prama("e")Employee emp);</span><br><span class="line">   取值：id==&gt;#&#123;param1&#125;   lastName==&gt;#&#123;param2.lastName/e.lastName&#125;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   ###特别注意，如果是Collection(List,set)类型或者是数组</span><br><span class="line">       也会做特殊处理，把传入的list或者数组封装到map中：</span><br><span class="line">       key:Collection (collection),如果是List还可以使用这个key: list</span><br><span class="line">       数组使用这个key: array</span><br><span class="line">public Employee getEmp(List&lt;Integer&gt; ids);</span><br><span class="line">   取值：取出第一个id的值 #&#123;list[0]&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>源码解析</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">(@Param("id")Integer id,@Param("lastName")String lastName);</span><br><span class="line"> ParamNameResolver解析参数封装map的：</span><br><span class="line">   1.names: &#123;0=id, 1=lastName&#125;</span><br><span class="line">     1.获取每个标了@Param注解的参数的值：id,lastName；复制给name</span><br><span class="line">     2.每次解析一个参数给map中保存信息：(key:参数的索引,value:name的值)</span><br><span class="line">       name的值：</span><br><span class="line">                      标了param注解：注解的值</span><br><span class="line">                      没有标注：</span><br><span class="line">                      1.全局配置：useActualParamName(jdk1.8)  name=参数名</span><br><span class="line">                      2.name=map.size();相当于当前元素的索引</span><br><span class="line">     &#123;0=id, 1=lastName,2=2&#125;</span><br><span class="line">     </span><br><span class="line">     args[1,"Tom","hello"]</span><br><span class="line">     public Object getNamedParams(Object[] args) &#123;</span><br><span class="line">      final int paramCount = names.size();</span><br><span class="line">      //1.如果没有参数直接返回</span><br><span class="line">      if (args == null || paramCount == 0) &#123;</span><br><span class="line">        return null;</span><br><span class="line">        </span><br><span class="line">        //2.如果有一个参数，并且参数没有标注param注解，那么返回args[0],单个参数直接返回</span><br><span class="line">      &#125; else if (!hasNamedParameters &amp;&amp; paramCount == 1) &#123;</span><br><span class="line">        return args[names.firstKey()];</span><br><span class="line">        </span><br><span class="line">       //3.如果有多个参数或者有param注解</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        final Map&lt;String, Object&gt; param = new ParamMap&lt;Object&gt;();</span><br><span class="line">        int i = 0;</span><br><span class="line">        </span><br><span class="line">        //4.遍历names集合&#123;0=id, 1=lastName&#125;</span><br><span class="line">        for (Map.Entry&lt;Integer, String&gt; entry : names.entrySet()) &#123;</span><br><span class="line">        </span><br><span class="line">        //names集合的value作为key; names的key又作为取值的参考args[key]:args[1,"Tom"]</span><br><span class="line">        //&#123;id=args[0]:1,lastName=args[1]:"Tom",2=args[2]:"hello"&#125;</span><br><span class="line">         </span><br><span class="line">          param.put(entry.getValue(), args[entry.getKey()]);</span><br><span class="line">          </span><br><span class="line">          // issue #71, add param names as param1, param2...but ensure backward compatibility</span><br><span class="line">         //额外的将每一个参数也保存到map中，使用新的key: param1,..,paramN</span><br><span class="line">         //效果：有注解param的可以#&#123;id/param1&#125;</span><br><span class="line">          final String genericParamName = "param" + String.valueOf(i + 1);</span><br><span class="line">          if (!param.containsKey(genericParamName)) &#123;</span><br><span class="line">            param.put(genericParamName, args[entry.getKey()]);</span><br><span class="line">          &#125;</span><br><span class="line">          i++;</span><br><span class="line">        &#125;</span><br><span class="line">        return param;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数值的获取</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> #&#123;&#125;:获取map中value的值或者对象中的属性的值</span><br><span class="line"> <span class="formula">$&#123;&#125;:获取map中value的值或者对象中的属性的值</span></span><br><span class="line"><span class="formula">     区别：#&#123;&#125;以预编译形式将参数设置到sql语句，PreparedStatment 防止sql注入</span></span><br><span class="line"><span class="formula">       $</span>&#123;&#125;将参数直接写入到sql语句中</span><br><span class="line">       </span><br><span class="line">       大多数情况我们使用#&#123;&#125;去获取值</span><br><span class="line">       但是在原生jdbc不支持占位符的情况中可以使用<span class="formula">$&#123;&#125;</span></span><br><span class="line"><span class="formula">       比如分表，排序：按照年份拆分分表</span></span><br><span class="line"><span class="formula">       select * from $</span>&#123;year&#125;_salary where xxx</span><br><span class="line">       select * from tb_emp order by <span class="formula">$&#123;f_name&#125; $</span>&#123;order&#125;   </span><br><span class="line">             </span><br><span class="line">#&#123;&#125;：更丰富的用法：</span><br><span class="line">        规定参数的一些规则</span><br><span class="line">    javaType,jdbcType,mode（存储过程）,....</span><br><span class="line">    </span><br><span class="line">    jdbcType通常需要在某种特定的条件下被设置：</span><br><span class="line">        在我们数据为null的时候，有些数据库可能不能识别mybatis对null的默认处理</span><br><span class="line">        比如oracle（会报错）</span><br><span class="line">    jdbcType OTHER：无效的类型：因为mybatis对所有为null都映射的是原生jdbc的OTHER类型</span><br><span class="line">    </span><br><span class="line">       解决办法：</span><br><span class="line">       1.全局配置：&lt;setting name="jdbcTypeForNull" value="NULL" /&gt;</span><br><span class="line">       2.#&#123;email,jdbcType=NULL&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="动态SQL"><a href="#动态SQL" class="headerlink" title="动态SQL"></a>动态SQL</h4><ul>
<li><p>if</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.jpg" alt="10"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.xidian.dao.EmployeeMapperDynamicSQL"</span>&gt;</span></span><br><span class="line">	 <span class="comment">&lt;!-- public List&lt;Employee&gt; getEmpByDynaSql(Employee employee); </span></span><br><span class="line"><span class="comment">	• if</span></span><br><span class="line"><span class="comment">	• choose (when, otherwise)</span></span><br><span class="line"><span class="comment">	• trim (where, set)</span></span><br><span class="line"><span class="comment">	• foreach</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	  if：</span></span><br><span class="line"><span class="comment">	    test ： 判断条件，和OGNL表达式一样  id指的是传入的参数的值</span></span><br><span class="line"><span class="comment">	        特殊符号可以使用转义字符</span></span><br><span class="line"><span class="comment">	    and ： &amp;amp;&amp;amp;</span></span><br><span class="line"><span class="comment">	    OGNL表达式会自动将数字字符串转成数字："0"=0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>where标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">       如果id没传,那么最终SQL会多一个and，导致报错</span><br><span class="line">    1.在where 后面加 1=1</span><br><span class="line">    2.使用where标签，会将第一个多余的and去掉(and放在前面的情况)</span><br><span class="line">            如果and是放在条件的后面，可能出现是SQL最后出现一个多余的and导致报错</span><br><span class="line"> --&gt;</span><br><span class="line"> <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByDynaSql"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">    select * from tb_emp where </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></span><br><span class="line">      id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"lastName!=null and lastName!=''"</span>&gt;</span></span><br><span class="line">      and last_name like #&#123;lastName&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email!=null and email.trim()!=''"</span>&gt;</span></span><br><span class="line">      and email=#&#123;email&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender==0 or gender==1"</span>&gt;</span></span><br><span class="line">       and gender=#&#123;gender&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​</p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/11.jpg" alt="11"></p>
<p><img src="/2020/07/16/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/12.jpg" alt="12"></p>
</li>
<li><p>trim标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--trim：解决where标签最终SQL中最后面存在and或者or的情况</span></span><br><span class="line"><span class="comment">    prefix:前缀，给trim拼接结果中的前面添加一个前缀</span></span><br><span class="line"><span class="comment">    prefixOverrides：将trim拼接结果中的前面去掉一个前缀</span></span><br><span class="line"><span class="comment">    suffix：给trim拼接结果中的后面添加一个后缀</span></span><br><span class="line"><span class="comment">    suffixOverrides：将trim拼接结果中的后面去掉一个后缀</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByTrim"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">   select * from tb_emp </span><br><span class="line">   <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"where"</span>  <span class="attr">suffixOverrides</span>=<span class="string">"and"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></span><br><span class="line">      id=#&#123;id&#125; and </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"lastName!=null and lastName!=''"</span>&gt;</span></span><br><span class="line">        last_name like #&#123;lastName&#125; and</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email!=null and email.trim()!=''"</span>&gt;</span></span><br><span class="line">       email=#&#123;email&#125; and</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender==0 or gender==1"</span>&gt;</span></span><br><span class="line">        gender=#&#123;gender&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>choose</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--getEmpByChoose  : 如果id存在则用id去查，如果id为空则用lastName去查,...</span></span><br><span class="line"><span class="comment">    choose标签： 相当于switch</span></span><br><span class="line"><span class="comment">      when-otherwise: 相当于case-default</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByChoose"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">   select * from tb_emp </span><br><span class="line">   <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></span><br><span class="line">	      id=#&#123;id&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"lastName!=null"</span>&gt;</span></span><br><span class="line">	      last_name like #&#123;lastName&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"email!=null"</span>&gt;</span></span><br><span class="line">	      email=#&#123;email&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        gender=1</span><br><span class="line">      <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>set标签更新</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--public void updateEmp(Employee employee);  </span></span><br><span class="line"><span class="comment">	   set：</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateEmp"</span>&gt;</span></span><br><span class="line">	      update tb_emp </span><br><span class="line">	      <span class="comment">&lt;!-- &lt;set&gt;</span></span><br><span class="line"><span class="comment">		      &lt;if test="lastName!=null"&gt;</span></span><br><span class="line"><span class="comment">		         last_name=#&#123;lastName&#125; ,</span></span><br><span class="line"><span class="comment">		      &lt;/if&gt;</span></span><br><span class="line"><span class="comment">		      &lt;if test="gender!=null"&gt;</span></span><br><span class="line"><span class="comment">		         gender=#&#123;gender&#125;,</span></span><br><span class="line"><span class="comment">		      &lt;/if&gt;</span></span><br><span class="line"><span class="comment">		      &lt;if test="email!=null"&gt;</span></span><br><span class="line"><span class="comment">		        email=#&#123;email&#125;</span></span><br><span class="line"><span class="comment">		      &lt;/if&gt;</span></span><br><span class="line"><span class="comment">		   &lt;/set&gt;</span></span><br><span class="line"><span class="comment">	       where id=#&#123;id&#125; --&gt;</span></span><br><span class="line">	       </span><br><span class="line">	       <span class="comment">&lt;!-- 也可以使用trim更新 --&gt;</span></span><br><span class="line">	       <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"set"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"lastName!=null"</span>&gt;</span></span><br><span class="line">		         last_name=#&#123;lastName&#125; ,</span><br><span class="line">		      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender!=null"</span>&gt;</span></span><br><span class="line">		         gender=#&#123;gender&#125;,</span><br><span class="line">		      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email!=null"</span>&gt;</span></span><br><span class="line">		        email=#&#123;email&#125;</span><br><span class="line">		      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">	       where id=#&#123;id&#125;</span><br><span class="line">	 <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>foreach遍历</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- public List&lt;Employee&gt; getEmpByForEach(List&lt;Integer&gt; ids); </span></span><br><span class="line"><span class="comment">  foreach：遍历集合</span></span><br><span class="line"><span class="comment">    collection：指定要遍历的集合   list类型的参数会特殊处理封装在map中，map的key就是list  直接使用list，或者使用@Param注解</span></span><br><span class="line"><span class="comment">    item：给遍历的集合起一个变量名，方便直接使用#&#123;变量名&#125;每次去一条记录</span></span><br><span class="line"><span class="comment">    open：给拼接的SQL字符串添加一个开始字符</span></span><br><span class="line"><span class="comment">    close：给拼接的SQL字符串添加一个结束字符</span></span><br><span class="line"><span class="comment">    separator：拼接的SQL字符串中两个索引之间的分隔符</span></span><br><span class="line"><span class="comment">    index：在list中index就是索引，item就是索引所代表的值</span></span><br><span class="line"><span class="comment">                      在map中index就是map的key，而item就是value</span></span><br><span class="line"><span class="comment">                      </span></span><br><span class="line"><span class="comment">    #&#123;item变量名&#125;取出每次遍历的一条记录</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByForEach"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">   select * from tb_emp where id in</span><br><span class="line">   <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"item_id"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">      #&#123;item_id&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>foreach做批量添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--public void addEmp(List&lt;Employee&gt; emp);  </span></span><br><span class="line"><span class="comment">   用foreach做批量增加</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addEmp"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- insert into tb_emp(last_name,gender,email,d_id) values</span></span><br><span class="line"><span class="comment">   &lt;foreach collection="list" item="item" separator=","&gt;</span></span><br><span class="line"><span class="comment">      (#&#123;item.lastName&#125;,#&#123;item.gender&#125;,#&#123;item.email&#125;,#&#123;item.dept.id&#125;)</span></span><br><span class="line"><span class="comment">   &lt;/foreach&gt; --&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">&lt;!--也可以批量多条insert的添加  但是需要开启mysql的一个属性：allowMultiQueries=true--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">separator</span>=<span class="string">";"</span>&gt;</span></span><br><span class="line">      insert into tb_emp(last_name,gender,email,d_id) </span><br><span class="line">      value(#&#123;item.lastName&#125;,#&#123;item.gender&#125;,#&#123;item.email&#125;,#&#123;item.dept.id&#125;)</span><br><span class="line">   <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>两个内置参数</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--public List&lt;Employee&gt; getEmpByInnerParam(Employee employee);</span></span><br><span class="line"><span class="comment">    不是只有方法传递过来的参数才能判断，取值。。。</span></span><br><span class="line"><span class="comment">  mybatis还有两个内置参数也可以</span></span><br><span class="line"><span class="comment"> _parameter：代表整个参数</span></span><br><span class="line"><span class="comment">          单个参数：就是这个参数</span></span><br><span class="line"><span class="comment">          多个参数：mybatis会将参数封装到map中，_parameter就是map</span></span><br><span class="line"><span class="comment"> _databaseId：如果配置了数据库标签databaseIdProvider，_databaseId就是当前数据库别名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByInnerParam"</span> <span class="attr">resultType</span>=<span class="string">"com.xidian.domain.Employee"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='mysql'"</span>&gt;</span></span><br><span class="line">    select * from tb_emp </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter!=null"</span>&gt;</span></span><br><span class="line">       where last_name=#&#123;_parameter.lastName&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='oracle'"</span>&gt;</span></span><br><span class="line">    select * from tb_employee </span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>bind标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--bind：将OGNL表达式绑定到一个变量中，方便后面对变量的引用  --&gt;</span></span><br><span class="line">	     <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"_lastName"</span> <span class="attr">value</span>=<span class="string">"'_'+lastName+'%'"</span>/&gt;</span></span><br><span class="line">	     <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter!=null"</span>&gt;</span></span><br><span class="line">	        where last_name like #&#123;_lastName&#125;</span><br><span class="line">	     <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	   <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>sql标签：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 抽取可重用的SQL</span></span><br><span class="line"><span class="comment">       sql抽取：将要重复查询的列，或者重复插入的列抽取出来，方便后面引用</span></span><br><span class="line"><span class="comment">       include：引用抽取出来的sql</span></span><br><span class="line"><span class="comment">       include还可以自定义一些property，然后在sql内部使用$&#123;name&#125;抽取</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"mySQL"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='mysql'"</span>&gt;</span></span><br><span class="line">    last_name,gender,email,d_id</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
  <insert id="addEmp">
    <!-- insert into tb_emp(last_name,gender,email,d_id) values
       <foreach collection="list" item="item" separator=",">
          (#{item.lastName},#{item.gender},#{item.email},#{item.dept.id})
       </foreach> -->

<pre><code>&lt;!--也可以批量多条insert的添加  但是需要开启mysql的一个属性：allowMultiQueries=true--&gt;
&lt;foreach collection=&quot;list&quot; item=&quot;item&quot; separator=&quot;;&quot;&gt;
  insert into tb_emp(
  &lt;include refid=&quot;mySQL&quot;/&gt;
  ) 
  value(#{item.lastName},#{item.gender},#{item.email},#{item.dept.id})
&lt;/foreach&gt;</code></pre>  </insert>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 两级缓存</span><br><span class="line"></span><br><span class="line">* 一级缓存</span><br><span class="line"></span><br><span class="line">  ~~~java</span><br><span class="line">  &#x2F;**一级缓存：(本地缓存)sqlsession级别的缓存，该缓存在sqlsession期间时一直开着的，</span><br><span class="line">  	 *           与数据库同一次会话期间查询的数据都放在本地缓存</span><br><span class="line">  	 *           查询相同的数据会直接从缓存中获取数据</span><br><span class="line">  	 *           </span><br><span class="line">  	 *           一级缓存失效(查询相同的数据，下次还需要从数据库中获取数据)</span><br><span class="line">  	 *           1.sqlsession不同</span><br><span class="line">  	 *           2.sqlsession相同，查询条件不同（实际上就是一级缓存中不存在后面的数据）</span><br><span class="line">  	 *           3.sqlsession相同，查询条件相同，但是在查第二次之前进行增删改操作(这次增删改可能对下次要查的数据产生影响)</span><br><span class="line">  	 *           4.sqlsession相同，查询条件相同，但是查第二次之前将sqlsession缓存内的数据全部清除了(缓存中不存在数据)</span><br><span class="line">  	 *&#x2F;</span><br><span class="line">  	public void testFirstCache() throws IOException&#123;</span><br><span class="line">  		SqlSessionFactory  sqlSessionFactory&#x3D;getSqlSessionFactory();</span><br><span class="line">  		SqlSession openSession &#x3D; sqlSessionFactory.openSession();</span><br><span class="line">  		try&#123;</span><br><span class="line">  			EmployeeMapper mapper &#x3D; openSession.getMapper(EmployeeMapper.class);</span><br><span class="line">  			Employee emp01 &#x3D; mapper.getEmpById(1);</span><br><span class="line">  			System.out.println(emp01);</span><br><span class="line">  			&#x2F;&#x2F;1.sqlsession不同</span><br><span class="line">  &#x2F;&#x2F;			SqlSession openSession2 &#x3D; sqlSessionFactory.openSession();</span><br><span class="line">  &#x2F;&#x2F;			EmployeeMapper mapper2 &#x3D; openSession2.getMapper(EmployeeMapper.class);</span><br><span class="line">  			</span><br><span class="line">  			&#x2F;&#x2F;2.sqlsession相同，查询条件不同（实际上就是一级缓存中不存在后面的数据）</span><br><span class="line">  &#x2F;&#x2F;			Employee emp02 &#x3D; mapper.getEmpById(4);</span><br><span class="line">  			</span><br><span class="line">  			&#x2F;&#x2F;3.sqlsession相同，查询条件相同，但是在查第二次之前进行增删改操作(这次增删改可能对下次要查的数据产生影响)</span><br><span class="line">  &#x2F;&#x2F;			Employee employee &#x3D; new Employee(&quot;ketty&quot;,&quot;1&quot;,&quot;ketty@xidian.com&quot;,null);</span><br><span class="line">  &#x2F;&#x2F;			mapper.addEmp(employee);</span><br><span class="line">  &#x2F;&#x2F;			openSession.commit();</span><br><span class="line">  			</span><br><span class="line">  			&#x2F;&#x2F;4.sqlsession相同，查询条件相同，但是查第二次之前将sqlsession缓存内的数据全部清除了(缓存中不存在数据)</span><br><span class="line">  			openSession.clearCache();</span><br><span class="line">  			</span><br><span class="line">  			Employee emp02 &#x3D; mapper.getEmpById(1);</span><br><span class="line">  			System.out.println(emp02);</span><br><span class="line">  			</span><br><span class="line">  			System.out.println(emp01&#x3D;&#x3D;emp02);</span><br><span class="line">  		&#125;finally&#123;</span><br><span class="line">  			openSession.close();</span><br><span class="line">  		&#125;</span><br><span class="line">  	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>二级缓存</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span>&gt;</span><span class="tag">&lt;/<span class="name">cache</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--cache: 二级缓存</span></span><br><span class="line"><span class="comment">         eviction：缓存回收策略</span></span><br><span class="line"><span class="comment">                   • LRU – 最近最少使用的，移除最长时间不被使用的对象</span></span><br><span class="line"><span class="comment">                   • FIFO – 先进先出，俺对象进入缓存的顺序来移除他们</span></span><br><span class="line"><span class="comment">                   • SOFT – 软引用，移除基于垃圾回收器状态和软引用规则的对象</span></span><br><span class="line"><span class="comment">                   • WEAK – 弱引用，更积极的移除基于垃圾收集器状态和弱引用规则的对象</span></span><br><span class="line"><span class="comment">          flushInterval：缓存刷新间隔时间</span></span><br><span class="line"><span class="comment">                                       缓存多长时间清空一次，默认不清空，</span></span><br><span class="line"><span class="comment">          readOnly: 是否只读</span></span><br><span class="line"><span class="comment">                    true：只读；mybatis认为所有从缓存中获取数据的操作都是只读操作，不会修改数据</span></span><br><span class="line"><span class="comment">                          mybatis为了加快获取速度，直接会将数据在缓存中的引用交给用户，不安全，速度快</span></span><br><span class="line"><span class="comment">                    false：非只读；mybatis觉得获取的数据可能会被修改，</span></span><br><span class="line"><span class="comment">                           mybatis会利用序列化&amp;反序列化的技术克隆一份新的数据给你，安全，速度慢</span></span><br><span class="line"><span class="comment">          size： 缓存中存放多少元素</span></span><br><span class="line"><span class="comment">          type：指定自定义缓存的全类名</span></span><br><span class="line"><span class="comment">                                实现cache接口的类的全类名</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**2.二级缓存：(全局缓存)基于namespace的缓存，一个namespace对应一个二级缓存</span></span><br><span class="line"><span class="comment">	 *           工作机制：</span></span><br><span class="line"><span class="comment">	 *           1.一个会话，查询一条数据，这个数据会被放在当前会话的一级缓存中</span></span><br><span class="line"><span class="comment">	 *           2.如果会话关闭，一级缓存中的数据会被保存到二级缓存中，新的会话查询信息，就可以参照二级缓存</span></span><br><span class="line"><span class="comment">	 *           3.sqlsession=====EmployeeMapper===&gt;Employee</span></span><br><span class="line"><span class="comment">	 *                            DepartmentMapper==&gt;Department</span></span><br><span class="line"><span class="comment">	 *                       不同的namespace会放在自己对应的缓存中(map)     </span></span><br><span class="line"><span class="comment">	 *                       效果：数据会从二级缓存中取出</span></span><br><span class="line"><span class="comment">	 *                            数据会优先放入一级缓存，如果一级缓存会话提交或关闭，才会将缓存中的数据保存到对应的二级缓存中</span></span><br><span class="line"><span class="comment">	 *                       </span></span><br><span class="line"><span class="comment">	 *           使用：</span></span><br><span class="line"><span class="comment">	 *           1.在全局配置中开启二级缓存  &lt;setting name="cacheEnabled" value="true"/&gt;</span></span><br><span class="line"><span class="comment">	 *           2.在映射文件中开启二级缓存   &lt;cache&gt;&lt;/cache&gt;</span></span><br><span class="line"><span class="comment">	 *           3.给POJO需要实现序列化接口      public class Employee implements Serializable</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testNameSpaceCache</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		SqlSessionFactory  sqlSessionFactory=getSqlSessionFactory();</span><br><span class="line">		SqlSession openSession = sqlSessionFactory.openSession();</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			EmployeeMapper mapper = openSession.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">			Employee emp01 = mapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">			System.out.println(emp01);</span><br><span class="line">			</span><br><span class="line">			openSession.close();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//第二次是直接从二级缓存中拿，并不是到数据库中取</span></span><br><span class="line">			SqlSession openSession2 = sqlSessionFactory.openSession();</span><br><span class="line">			EmployeeMapper mapper2 = openSession2.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">			</span><br><span class="line">			Employee emp02 = mapper2.getEmpById(<span class="number">1</span>);</span><br><span class="line">			System.out.println(emp02);</span><br><span class="line">			</span><br><span class="line">			System.out.println(emp01==emp02);</span><br><span class="line">			openSession2.close();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>和缓存有关的设置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 3.和缓存有关的设置：</span></span><br><span class="line"><span class="comment">*      1.cacheEnabled=true: false关闭二级缓存，一级缓存一直可用</span></span><br><span class="line"><span class="comment">*      2.每个select标签都有一个useCache="true" : false关闭二级缓存，一级缓存可用</span></span><br><span class="line"><span class="comment">*      3.每个增删改标签都有一个flushCache="true": 增删改标签：一级二级缓存都会被清除</span></span><br><span class="line"><span class="comment">*                                              查询标签：false则不清楚缓存，为true则清除缓存</span></span><br><span class="line"><span class="comment">*      4.openSession2.clearCache();只清除当前session的一级缓存</span></span><br><span class="line"><span class="comment">*      5.localCacheScope：本地缓存作用域：SESSION | STATEMENT</span></span><br><span class="line"><span class="comment">*                         SESSION：当前session可用</span></span><br><span class="line"><span class="comment">*                         STATEMENT：禁用一级缓存</span></span><br><span class="line"><span class="comment">* 4.缓存查询顺序：</span></span><br><span class="line"><span class="comment">*   先查询二级缓存</span></span><br><span class="line"><span class="comment">*   再查询一级缓存</span></span><br><span class="line"><span class="comment">*   如果都没有才去数据库查询</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 5.数据存储顺序</span></span><br><span class="line"><span class="comment">*   数据会优先放入一级缓存，如果一级缓存会话提交或关闭，才会将缓存中的数据保存到对应的二级缓存中</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 6.第三方缓存整合：</span></span><br><span class="line"><span class="comment">*   1.导入第三方缓存包</span></span><br><span class="line"><span class="comment">*   2.导入与第三方缓存包整合的适配包：官方有</span></span><br><span class="line"><span class="comment">*   3.mapper.xml中使用自定义缓存&lt;cache type="自定义缓存类路径"/&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="mybatis整合spring"><a href="#mybatis整合spring" class="headerlink" title="mybatis整合spring"></a>mybatis整合spring</h4>
      
    </div>
    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">--------本文结束 <i class="fa fa-paw"></i> 感谢您的阅读--------</div>
    
</div>

      
    </div>

    <div>
        
            


        
    </div>

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    yang qian
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://canghaizanhua6.github.io/2020/07/16/Mybatis学习笔记/" title="Mybatis学习笔记">http://canghaizanhua6.github.io/2020/07/16/Mybatis学习笔记/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> Mybatis学习笔记</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/07/16/%E6%90%9C%E7%B4%A2/" rel="next" title="搜索">
                <i class="fa fa-chevron-left"></i> 搜索
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/07/16/SpringMVC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="prev" title="SpringMVC学习笔记">
                SpringMVC学习笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80OTg1NS8yNjM0Ng"></div>
    </div>

  





        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/%E5%A4%B4%E5%83%8F.jpg"
                alt="yang qian" />
            
              <p class="site-author-name" itemprop="name">yang qian</p>
              <p class="site-description motion-element" itemprop="description">愿你在冷铁卷刃前  得以窥见天光</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/canghaizanhua6/" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/canghaichanghua/" target="_blank" title="csdn">
                      
                        <i class="fa fa-fw fa-crosshairs"></i>csdn</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Mybatis学习"><span class="nav-number">1.</span> <span class="nav-text">Mybatis学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基础知识"><span class="nav-number">1.1.</span> <span class="nav-text">基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#为什么要使用Mybatis"><span class="nav-number">1.1.1.</span> <span class="nav-text">为什么要使用Mybatis?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mybatis框架原理"><span class="nav-number">1.1.2.</span> <span class="nav-text">mybatis框架原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mybatis入门程序"><span class="nav-number">1.1.3.</span> <span class="nav-text">mybatis入门程序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置文件"><span class="nav-number">1.2.</span> <span class="nav-text">配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#全局配置文件"><span class="nav-number">1.2.1.</span> <span class="nav-text">全局配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#映射配置文件"><span class="nav-number">1.2.2.</span> <span class="nav-text">映射配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#动态SQL"><span class="nav-number">1.2.3.</span> <span class="nav-text">动态SQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mybatis整合spring"><span class="nav-number">1.2.4.</span> <span class="nav-text">mybatis整合spring</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>

       <!-- 此处为新加的代码 -->
       <script src="https://cdn.staticfile.org/jquery/3.1.1/jquery.min.js"></script>
<script>
    //暂时储存文章中的内容
    var div = $('.post-body');
    //暂时储存目录的内容
    //var toc=$('.post-toc-wrap')
    var toc=$('.nav')
    function password() {
        if(''){
            //将文章内容删除
            div.remove();
            //将目录删除
            toc.remove();
            //将文章删除后，向原来文章的地方添加，应该出现的提示用户输入密码的样式
            //下面这里的第一个用textarea是因为如果在手机端的时候只能显示一部分文字，
            //只是拓展:input里面的字只能显示一行，不会自动换行，目前上网搜索没有发现好的办法，所以用了textarea，右下角的小三角通过resize:none 去掉。
            $('.post-header').after(
            '<span class="description" value="请输入密码，然后按 Enter 键阅读" style="font-style: oblique;font-weight: bold;border: none;display: block;'+
            'width: 60%;margin: 0 auto;text-align: center;outline: none;margin-bottom: 40px;resize:none ">'+
            '<i class="fa fa-heartbeat" id="myheartbeat"></i>'+
            '请输入密码，然后按 Enter 键阅读' +
            '<i class="fa fa-heartbeat" id="myheartbeat"></i>'+
            '</span>' +
            '<div class="qiang" style="height: 100px;width: 60%;margin:0 auto">' +
            '<input class="password"  type="password" autocomplete="new-password" autofocus="autofocus" value="" style="border-radius: 5px;height: 30px;border: none;display: block;border-bottom: 1px solid #ccc;' +
            'margin: 0 auto;outline: none;width:95%"/>' +
            '</div>')
            //绑定点击事件，如果是点击的.password 这个div就改变样式，如果是document中除了div之外的其他任何元素，就变回原来的样式。
            document.onclick = function (event) {
                var e = event || window.event;
                var elem = e.srcElement || e.target;

                while (elem) {
                    if (elem != document) {
                        if (elem.className == "password") {
                            //$(".password").animate({paddingTop:"30px",width:"100%",borderWidth:"2px"},300)
                            return;
                        }
                        elem = elem.parentNode;
                    } else {
                        //$(".password").animate({paddingTop:"0px",width:"95%",borderWidth:"1px"},300)
                        return;
                    }
                }
            }
            //绑定enter键按下后离开的事件
            $(document).keyup(function(event){
                if(event.keyCode ==13&&$('.password').length>0){
                    //console.log($('.password').val())
                    //console.log('')
                    if ($('.password').val() == '') {
                        //恢复文章内容
                        (div).appendTo($(".post-header"))
                        //恢复目录
                        toc.appendTo($(".sidebar-inner"))
                        //删除本页面的输入密码组件
                        $(".description").remove();
                        $(".qiang").remove();
                        $(".password").remove();

                        //重新处理pjax事件,如果没有加pjax的从下面这行起到下面的else之间的代码需要去掉。
                        //图片懒加载，没有加入此功能的这个函数需要去掉
                        $('img').lazyload({
                            placeholder: '/images/loading.gif',
                            effect: 'fadeIn',
                            threshold : 100,
                            failure_limit : 20,
                            skip_invisible : false
                        });
                        //pjax后出现文章不显示，没有pjax的下面四行需要去掉
                        $(".post-block").css({opacity:1});
                        $(".post-header").css({opacity:1});
                        $(".post-body").css({opacity:1});
                        $(".pagination").css({opacity:1});
                    }else {
                        alert("对不起，密码输入错误。")
                    }
                }
                //将document的keyup移除，防止在pjax的情况下会重复绑定事件
            });
        }
    }
    password();
</script>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-star">
    <i class="fa fa-star"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">true</span>

  
</div>


  <span class="post-meta-divider">|</span>


<!--
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>

-->




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">全站共 45.4k 字</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
  

  
  
    <script type="text/javascript" src="true"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>





  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  




  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  











  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("UDyIQm6LMgRJA3JUHSEyevtr-gzGzoHsz#<app_id>", "rFj4ymUjblvTIyD2QF9UjSyN#<app_key>");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

  
  
    <script src="/js/cursor/fireworks.js"></script>
  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":120,"height":240},"mobile":{"show":true},"react":{"opacityDefault":1,"opacityOnHover":1},"log":false,"tagMode":false});</script></body>
</html>

